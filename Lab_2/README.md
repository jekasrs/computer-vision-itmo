# Лабораторная работа №2
ФИО: Смирнов Евгений Александрович  
Группа: P4222  
Предмет: Компьютерное зрение  
Лабораторная работа: Реализация алгоритма трекинга объектов на видео на основе ключевых точек и оптического потока  

---

### 1. Теоретическая база

**Ключевые точки (Shi–Tomasi)**  
Алгоритм Shi–Tomasi используется для обнаружения устойчивых и информативных ключевых точек изображения. 
Метод является улучшением детектора Харриса и выбирает точки с максимальным собственным значением матрицы градиентов.

**Оптический поток (Lucas–Kanade)**  
Метод Lucas–Kanade основан на предположении о постоянстве яркости пикселей и малых смещениях между соседними кадрами.
Используется для отслеживания движения ключевых точек между кадрами видео.

**Методы отрисовки рамки**  
- Bounding Box (BBox) — построение прямоугольника по экстремальным координатам ключевых точек.
- Гомография — вычисление матрицы перспективного преобразования и перенос рамки объекта с учетом поворотов и искажений.

---

## 2. Архитектура программы

Программа состоит из следующих этапов:
1. Загрузка видео
2. Выбор области интереса (ROI)
3. Поиск ключевых точек в ROI
4. Отслеживание точек с помощью оптического потока
5. Визуализация результата (BBox или гомография)

---

## 3. Описание алгоритма

1. Пользователь выбирает объект на первом кадре
2. В выбранной области находятся ключевые точки методом Shi–Tomasi
3. Для последовательных кадров вычисляется оптический поток Lucas–Kanade
4. Отфильтрованные точки используются для:
   - обновления bounding box  
   - или пересчета гомографии
5. Результат отображается в реальном времени

---

## 4. Результаты

Тестирование проводилось:
- на трех тестовых видео с различным движением объектов
- на собственноручно записанном видео с похожим объектом

Для запуска в режиме 'bbox' нужно использовать команду 

```commandline
python3 main.py --video=mona-lisa.avi --mode=bbox
```

Для запуска в режиме 'homography' нужно использовать команду 
```commandline
python3 main.py --video=mona-lisa.avi --mode=homography
```

Алгоритм устойчиво отслеживает объект при:
- умеренных поворотах
- частичном перекрытии
- плавном движении камеры

Гомография показала лучшие результаты при вращении объекта.

---

## 5. Выводы по работе

В ходе лабораторной работы был реализован алгоритм трекинга объектов на видео на основе ключевых точек и оптического потока.
Изучены принципы работы Shi–Tomasi и Lucas–Kanade, а также способы визуализации движения объекта.

---

## 6. Список источников

1. OpenCV Documentation — Feature Detection and Optical Flow  
2. Shi, J., Tomasi, C. *Good Features to Track*, CVPR, 1994  
